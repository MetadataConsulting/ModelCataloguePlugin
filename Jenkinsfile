pipeline {
  agent any
  options {
    disableConcurrentBuilds()
  }
  stages {
    stage('Test Execute') {
      steps {
        dir(path: 'ModelCatalogueCorePluginTestApp') {
            sh 'npm install'
            sh 'bower install'
            wrap([$class: 'Xvfb']) {
              sh 'echo "Testing UserIsAbleToDownloadAnAssetSpec etc."';
				sh '/opt/grails/bin/grails test-app -Dserver.port=8081 -Dgeb.env=chrome -DdownloadFilepath=/home/ubuntu/download -Dwebdriver.chrome.driver=/opt/chromedriver functional: UserIsAbleToDownloadAnAssetSpec CanCreateDataTypeFromCreateDataElementWizardSpec AddAndRemoveManyDataElementsSpec CheckCreateElementFromClassWizardSpec MaxOccursShowsInHistorySpec NewDraftEditFromImportedModelsAreUpdatedSpec VerifyMinOccursCanBeZeroSpec CheckDataModelCanBeFinalizedSpec CheckDataModelPoliciesSpec CheckDataModelPolicyEnumeratedTypeSpec CheckDataModelPolicyTagSpec CloneUnauthorizedElementSpec CreateNewVersionOfDataModelSpec CannotCreateDataElementWithUnauthorizedDataTypeSpec CheckDataTypeAddedToNewVersionSpec ValidateValueAgainstDataTypeSpec CannotAddAssetToFinalizedDataModelSpec CannotAddBusinessRulesToFinalizedDataModelSpec CannotAddDataClassesToFinalizedDataModelSpec CannotAddDataElementsToFinalizedDataModelSpec CannotAddDataTypesToFinalizedDataModelSpec CannotAddElementToFinalizedModelSpec CannotAddMeasurementUnitToFinalizedDataModelSpec CannotAddTagsToFinalizedDataModelSpec AbstractModelCatalogueGebSpec ImportMcSpec ImportXmlAndExcelDataSpec CuratorCanGenerateSuggestionsUsingMappingUtilitySpec';
				sh 'echo "Testing CloneAanClassIntoAnotherModelSpec etc."';
				sh '/opt/grails/bin/grails test-app -Dserver.port=8081 -Dgeb.env=chrome -DdownloadFilepath=/home/ubuntu/download -Dwebdriver.chrome.driver=/opt/chromedriver functional: CloneAanClassIntoAnotherModelSpec CompareTwoDataModelSpec CreateDataModelAndCreatePolicesSpec CreateNewVersionFromFinalisedToDraftSpec CustomMetadataNotCarriedNewVersionSpec InvalidRegistrationSpec MaxOccursIsShowingInHistorySpec VerifyResetPasswordPresentOnLoginPageSpec VerifyUserCanTagUsingTreeViewSpec AbleToNavigateToOldVersionOfAModelThroughTreeSpec CanCreateDataElementAndCloneDataTypeSpec CanCreateDataTypeSpec CanImportDataModelSpec CannotDeleteFinalizedDataModelSpec CanSelectPoliciesWhileCreatingDataModelSpec FinalizedDataModelIsMarkedAsFinalizedInXMLSpec HistoryIsPopulatedAccordingToModelActivitySpec ImportAndRemoveDataModelReflectsInHistorySpec UnableToImportIfReadAccessSpec UserCanFinalizeDataModelSpec AdminCanCreateModelAndPolicySpec AdminUserCannotDeleteFinalizedItemsSpec CheckAdminCanDeleteImportedModelSpec CuratorCanCreateANewDataClassSpec CuratorCanImportFinalizedDataModelSpec CuratorCannotCreateClassInFinalizedModelSpec CuratorCannotEditFinalizedModelSpec CuratorWithAdminCanDeleteClassInDraftModelSpec';
				sh 'echo "Testing DisableUserSpec etc."';
				sh '/opt/grails/bin/grails test-app -Dserver.port=8081 -Dgeb.env=chrome -DdownloadFilepath=/home/ubuntu/download -Dwebdriver.chrome.driver=/opt/chromedriver functional: DisableUserSpec FinalizedDataModelMenuVisibilitySpec UserCanEditDataClassesForAdminDataModelSpec UserCannotEditReadOnlyDataModelSpec UsersDontSeeUnauthorizedDataModelsSpec VerifyCuratorCannotDeleteFinalizedDataModelSpec VerifyRegularUserCanSeeApiKeySpec VerifySupervisorCanActionSettingsSpec VerifyViewerCannotAccessFactActionsSpec ApiKeySpec CreateAssetsAndImportDataSpec CreateBusinessRulesSpec CreateDataClassSpec CreateDataModelSpec CreateDataTypeAndSelectEnumeratedSpec CreateDataTypeAndSelectReferenceSpec CreateDataTypeAndSelectSubsetSpec CreateMeasurementUnitSpec CreateNewDataElementSpec CreateRelationshipSpec CreateTagSpec SearchMoreOptionPolicySpec CreateDataTypeAndSelectPrimitiveSpec DataModelSearchSpec CreateMeasurementUnitFromFavouritesSpec DevSupportedLinkSpec AddDataInToFavouritesSpec AddDataModelImportSpec';
				sh 'echo "Testing AddUsernameToFavouriteSpec etc."';
				sh '/opt/grails/bin/grails test-app -Dserver.port=8081 -Dgeb.env=chrome -DdownloadFilepath=/home/ubuntu/download -Dwebdriver.chrome.driver=/opt/chromedriver functional: AddUsernameToFavouriteSpec CodeVersionSpec EditDataElementSpec LastSeenSpec ModelCatalogueDevelopmentSpec NavItemVisibilitySpec QuickSearchSpec RelationshipHasAttachmentOfSpec RelationshipImportsSpec RelationshipIsBaseForSpec RelationshipIsImportedBySpec RelationshipIsSynonymForSpec RelationshipRelatedToSpec SearchCatalogueModelsSpec LoginAsViewerSpec LoginInAndClickOnCancelSpec LoginSpec ResetPasswordSpec ValidateRegistrationSpec LogoutSpec ApiKeyUrlMappingsSecuredSpec CatalogueElementUrlMappingsSecuredSpec ClassificationUrlMappingsSecuredSpec CsvTransformationUrlMappingsSecuredSpec DataArchitectUrlMappingsSecuredSpec DataClassUrlMappingsSecuredSpec DataElementUrlMappingsSecuredSpec DataImportCreateUrlMappingsSecuredSpec';
				sh 'echo "Testing DataModelPolicyUrlMappingsSecuredSpec etc."';
				sh '/opt/grails/bin/grails test-app -Dserver.port=8081 -Dgeb.env=chrome -DdownloadFilepath=/home/ubuntu/download -Dwebdriver.chrome.driver=/opt/chromedriver functional: DataModelPolicyUrlMappingsSecuredSpec DataModelUrlMappingsSecuredSpec DataTypeUrlMappingsSecuredSpec EnumeratedTypeUrlMappingsSecuredSpec LastSeenUrlMappingsSecuredSpec LogsUrlMappingsSecuredSpec MeasurementUnitUrlMappingsSecuredSpec ModelCatalogueCorePluginUrlMappingsSecuredSpec ModelCatalogueFormsUrlMappingsSecuredSpec ModelCatalogueGenomicsUrlMappingsSecuredSpec ModelCatalogueNorthThamesUrlMappingsSecuredSpec ModelCatalogueVersionUrlMappingsSecuredSpec ReindexCatalogueUrlMappingsSecuredSpec UserUrlMappingSecuredSpec GrantRoleCuratorSpec AssetWizardSpec BatchAndActionsSpec ChangeLogForEligibilitySpec ChangesSpec DataClassWizardSpec DataElementWizardSpec DataModelWizardSpec DataTypeWizardSpec MeasurementUnitWizardSpec RegisterSpec SearchFunctionalSpec ValidationRuleWizardSpec VersionVerificationSpec'
            }

        }
      }
    }
  }
}